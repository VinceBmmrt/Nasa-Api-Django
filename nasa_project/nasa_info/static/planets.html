<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Planet Selection</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="{% static 'css/styles.css' %}"
    />
    <script src="https://cdn.jsdelivr.net/npm/spin.js@2.0.2/spin.min.js"></script>
  </head>
  <body>
    <header>
      <h1>Select a Planet</h1>
    </header>
    <div id="loader"></div>
    <div class="container" id="content" style="display: none">
      <h1 id="title"></h1>
      <img id="image" src="" alt="Planet Image" />
      <p id="explanation"></p>
    </div>
    <select id="planet-selector">
      <option value="" disabled selected>Select a planet</option>
      <option value="mercury">Mercury</option>
      <option value="venus">Venus</option>
      <option value="earth">Earth</option>
      <option value="mars">Mars</option>
      <option value="jupiter">Jupiter</option>
      <option value="saturn">Saturn</option>
      <option value="uranus">Uranus</option>
      <option value="neptune">Neptune</option>
    </select>
    <script>
      const opts = {
        lines: 13,
        length: 38,
        width: 17,
        radius: 39,
        scale: 1,
        corners: 1,
        color: "#3498db",
        fadeColor: "transparent",
        animation: "spinner-line-fade-default",
        rotate: 0,
        speed: 1,
        zIndex: 2e9,
        className: "spinner",
        top: "50%",
        left: "50%",
        position: "absolute",
      };

      const target = document.getElementById("loader");
      const spinner = new Spinner(opts).spin(target);

      async function fetchPlanetData(planet) {
        try {
          const response = await fetch(`/api/planet/${planet}/`);
          const data = await response.json();

          document.getElementById("title").textContent = data.title;
          document.getElementById("image").src = data.url;
          document.getElementById("explanation").textContent = data.explanation;
        } catch (error) {
          console.error("Error fetching planet data:", error);
        } finally {
          spinner.stop();
          document.getElementById("content").style.display = "block";
        }
      }

      document
        .getElementById("planet-selector")
        .addEventListener("change", (event) => {
          const planet = event.target.value;
          document.getElementById("content").style.display = "none";
          spinner.spin(target);
          fetchPlanetData(planet);
        });
    </script>
  </body>
</html>
